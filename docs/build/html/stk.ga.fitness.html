

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>stk.ga.fitness module &mdash; stk  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> stk
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">stk.ga.fitness module</a><ul>
<li><a class="reference internal" href="#how-fitness-values-are-calculated">How fitness values are calculated.</a></li>
<li><a class="reference internal" href="#extending-stk-adding-fitness-functions">Extending stk: Adding fitness functions.</a></li>
<li><a class="reference internal" href="#a-note-on-plotting">A note on plotting.</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stk</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>stk.ga.fitness module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stk.ga.fitness.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-stk.ga.fitness">
<span id="stk-ga-fitness-module"></span><h1>stk.ga.fitness module<a class="headerlink" href="#module-stk.ga.fitness" title="Permalink to this headline">¶</a></h1>
<p>Module for defining fitness functions.</p>
<div class="section" id="how-fitness-values-are-calculated">
<h2>How fitness values are calculated.<a class="headerlink" href="#how-fitness-values-are-calculated" title="Permalink to this headline">¶</a></h2>
<p>The basic outline of the fitness calculation procedure for a single
molecule is as follows,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Start with a MacroMolecule instance.</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Polymer</span><span class="p">([</span><span class="n">monomer1</span><span class="p">,</span> <span class="n">monomer2</span><span class="p">],</span> <span class="n">SomeTopology</span><span class="p">())</span>

<span class="c1"># This new instance has had no fitness functions applied to it</span>
<span class="c1"># and therefore its &quot;fitness&quot; and &quot;unscaled_fitness&quot; attributes</span>
<span class="c1"># are empty.</span>
<span class="n">mol</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># None</span>
<span class="n">mol</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {}</span>

<span class="c1"># 2. Apply a fitness function to the MacroMolecule.</span>
<span class="n">mol</span><span class="o">.</span><span class="n">unscaled_fitness</span><span class="p">[</span><span class="s1">&#39;random_fitness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random_fitness</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="c1"># This adds the unscaled fitness value into the &quot;unscaled_fitness&quot;</span>
<span class="c1"># attribute, but does not change the &quot;fitness&quot; attribute.</span>
<span class="n">mol</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># None</span>
<span class="n">mol</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {&#39;random_fitness&#39;: 34}</span>

<span class="c1"># 3.Copy the value from &quot;unscaled_fitness&quot; into &quot;fitness&quot;.</span>
<span class="n">mol</span><span class="o">.</span><span class="n">fitness</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">unscaled_fitness</span><span class="p">[</span><span class="s1">&#39;random_fitness&#39;</span><span class="p">])</span>

<span class="n">mol</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># 34</span>
<span class="n">mol</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {&#39;random_fitness&#39;: 34}</span>

<span class="c1"># 4. Apply any number of normalization functions to the fitness</span>
<span class="c1">#    value. Normalization functions can be skipped altogether.</span>

<span class="c1"># Normalization functions act on a population of MacroMolecules,</span>
<span class="c1"># i.e. they normalize the fitness values across the population. So</span>
<span class="c1"># first step is to put the molecule into a population.</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">GAPopulation</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="c1"># Apply the normalization function.</span>
<span class="n">norm_func</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>

<span class="n">mol</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># 12</span>
<span class="n">mol</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {&#39;random_fitness&#39;: 34}</span>

<span class="c1"># Multiple normalization functions may be applied.</span>
<span class="n">norm_func2</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>

<span class="n">mol</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># 200</span>
<span class="n">mol</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {&#39;random_fitness&#39;: 34}</span>
</pre></div>
</div>
<p>When running the GA, this process is much simplified,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start with a population of molecules, representing a GA</span>
<span class="c1"># generation.</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">GAPopulation</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="n">mol3</span><span class="p">)</span>

<span class="n">mol1</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># None</span>
<span class="n">mol1</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {}</span>

<span class="n">mol2</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># None</span>
<span class="n">mol2</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {}</span>

<span class="n">mol3</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># None</span>
<span class="n">mol3</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {}</span>

<span class="c1"># Calculate the unscaled fitness values of all molecules.</span>
<span class="n">pop</span><span class="o">.</span><span class="n">calculate_member_fitness</span><span class="p">()</span>

<span class="n">mol1</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># None</span>
<span class="n">mol1</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {&#39;random_fitness&#39;: 12}</span>

<span class="n">mol2</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># None</span>
<span class="n">mol2</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {&#39;random_fitness&#39;: 34}</span>

<span class="n">mol3</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># None</span>
<span class="n">mol3</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {&#39;random_fitness&#39;: 22}</span>

<span class="c1"># Apply the normalization functions.</span>
<span class="n">pop</span><span class="o">.</span><span class="n">normalize_fitness_values</span><span class="p">()</span>

<span class="n">mol1</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># 3</span>
<span class="n">mol1</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {&#39;random_fitness&#39;: 12}</span>

<span class="n">mol2</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># 1</span>
<span class="n">mol2</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {&#39;random_fitness&#39;: 34}</span>

<span class="n">mol3</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># 2</span>
<span class="n">mol3</span><span class="o">.</span><span class="n">unscaled_fitness</span>  <span class="c1"># {&#39;random_fitness&#39;: 22}</span>
</pre></div>
</div>
<p>The method <a class="reference internal" href="stk.ga.ga_population.html#stk.ga.ga_population.GAPopulation.normalize_fitness_values" title="stk.ga.ga_population.GAPopulation.normalize_fitness_values"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GAPopulation.normalize_fitness_values()</span></code></a> automatically
copies the fitness value from <a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.unscaled_fitness" title="stk.molecular.molecules.MacroMolecule.unscaled_fitness"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.unscaled_fitness</span></code></a>
into <a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.fitness" title="stk.molecular.molecules.MacroMolecule.fitness"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.fitness</span></code></a> before applying any normalization
functions. A fitness function is only applied once per molecule,
because the result depends only on the molecule. However, normalization
functions are re-applied every generation. This is because for some
normalization functions, the returned value for a molecule may also
depend on the other molecules in the population. At each generation,
a fresh copy of the value from <a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.unscaled_fitness" title="stk.molecular.molecules.MacroMolecule.unscaled_fitness"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.unscaled_fitness</span></code></a>
is made into <a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.fitness" title="stk.molecular.molecules.MacroMolecule.fitness"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.fitness</span></code></a>. This means that the
normalization functions always start from the unscaled fitness value.</p>
</div>
<div class="section" id="extending-stk-adding-fitness-functions">
<span id="adding-fitness-functions"></span><h2>Extending stk: Adding fitness functions.<a class="headerlink" href="#extending-stk-adding-fitness-functions" title="Permalink to this headline">¶</a></h2>
<p>To add a new fitness function simply write it as a function in this
module. It will need to take the <a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule" title="stk.molecular.molecules.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a> instance as
its first argument and this argument should be called <cite>macro_mol</cite>. The
purpose of this is to help users identify which arguments are handled
automatically by <code class="docutils literal notranslate"><span class="pre">stk</span></code> and which they need to define in the input
file. The convention is that if the fitness function takes an argument
called <cite>macro_mol</cite>, they do not have to specify that argument in the
input file.</p>
<p>A fitness function must return the value which represents the fitness
of the molecule <cite>macro_mol</cite>. If a fitness function is meant to be
paired with a normalization function it can return any value or
object it likes. Just as long as the normalization functions know how
to deal with it and convert it to a number.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">random_fitness</span><span class="p">(</span><span class="n">macro_mol</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
<p>Obviously, this is a just toy example but all the key components of
fitness functions are there. More complex fitness functions can take
an arbitrary number arguments, and will likely use molecular properties
to calculate a fitness value. Here is a fitness function which rewards
molecules for having a desired size.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="n">macro_mol</span><span class="p">,</span> <span class="n">desired_size</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">macro_mol</span><span class="o">.</span><span class="n">max_diameter</span><span class="p">()</span> <span class="o">-</span> <span class="n">desired_size</span><span class="p">)</span>
</pre></div>
</div>
<p>A fitness function may be complex and may not fit neatly into a single
function. For example, the <a class="reference internal" href="#stk.ga.fitness.cage_target" title="stk.ga.fitness.cage_target"><code class="xref py py-func docutils literal notranslate"><span class="pre">cage_target()</span></code></a> needs to call
<a class="reference internal" href="#stk.ga.fitness._generate_complexes" title="stk.ga.fitness._generate_complexes"><code class="xref py py-func docutils literal notranslate"><span class="pre">_generate_complexes()</span></code></a> in order to sample various conformations
before outputting a fitness value. This is fine. Define helper
functions such as <a class="reference internal" href="#stk.ga.fitness._generate_complexes" title="stk.ga.fitness._generate_complexes"><code class="xref py py-func docutils literal notranslate"><span class="pre">_generate_complexes()</span></code></a> within this module but
make sure they are private. This means that names of helper functions
begin with a leading underscore.</p>
</div>
<div class="section" id="a-note-on-plotting">
<span id="plotting-note"></span><h2>A note on plotting.<a class="headerlink" href="#a-note-on-plotting" title="Permalink to this headline">¶</a></h2>
<p>As mentioned before, some fitness functions may be complex and as a
result manipulate all sorts of data. Typically, in order to measure the
progress of a GA, the fitness values in the population are tracked
across generations. However, let’s say that some hypothetical fitness
function also calculates the energies of molecules. It may be quite
interesting plot the evolution of energies across generations too, even
if the energy is not directly reflect in the final fitness value. If
this is the case, the fitness function may assign to the
<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.progress_params" title="stk.molecular.molecules.MacroMolecule.progress_params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.progress_params</span></code></a> attribute of <cite>macro_mol</cite>,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">example_func</span><span class="p">(</span><span class="n">macro_mol</span><span class="p">):</span>
    <span class="n">mol_energy</span> <span class="o">=</span> <span class="n">macro_mol</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">some_energy_func</span><span class="p">()</span>
    <span class="n">macro_mol</span><span class="o">.</span><span class="n">progress_params</span><span class="p">[</span><span class="s1">&#39;example_func&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol_energy</span><span class="p">]</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Now a plot showing the change in <code class="docutils literal notranslate"><span class="pre">mol_energy</span></code> across generations will
be made too, along with the plot showing the changes in fitness.</p>
<p>What if two things are needed to be kept track of? Simple,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">example_func</span><span class="p">(</span><span class="n">macro_mol</span><span class="p">):</span>
    <span class="n">mol_energy</span> <span class="o">=</span> <span class="n">macro_mol</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">some_energy_func</span><span class="p">()</span>
    <span class="n">mol_radius</span> <span class="o">=</span> <span class="n">macro_mol</span><span class="o">.</span><span class="n">max_diamater</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">macro_mol</span><span class="o">.</span><span class="n">progress_params</span><span class="p">[</span><span class="s1">&#39;example_func&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol_energy</span><span class="p">,</span>
                                                 <span class="n">mol_radius</span><span class="p">]</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Great, now a separate progress plot <code class="docutils literal notranslate"><span class="pre">mol_energy</span></code> and <code class="docutils literal notranslate"><span class="pre">mol_radius</span></code>
will be made.</p>
<p>How will the y-axes be labelled in each plot? The decorator
<a class="reference internal" href="#stk.ga.fitness._param_labels" title="stk.ga.fitness._param_labels"><code class="xref py py-func docutils literal notranslate"><span class="pre">_param_labels()</span></code></a> exists for this.</p>
<p>Let’s create a basic outline of a some fitness function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@_param_labels</span><span class="p">(</span><span class="s1">&#39;Molecule Energy / J mol-1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mol Radius / m-9&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">some_fitness_fn</span><span class="p">(</span><span class="n">macro_mol</span><span class="p">,</span> <span class="n">some_param</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">calculate_stuff</span><span class="p">()</span>
    <span class="o">...</span>
    <span class="n">macro_mol</span><span class="o">.</span><span class="n">progress_params</span><span class="p">[</span><span class="s1">&#39;some_fitness_fn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol_energy</span><span class="p">,</span>
                                                    <span class="n">mol_radius</span><span class="p">]</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">fitness_value</span>
</pre></div>
</div>
<p>If this function is used in the GA, a progress plot will be made for
each variable placed in <a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.progress_params" title="stk.molecular.molecules.MacroMolecule.progress_params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.progress_params</span></code></a> and
they will have their y-axes labelled <code class="docutils literal notranslate"><span class="pre">'Molecule</span> <span class="pre">Energy</span> <span class="pre">/</span> <span class="pre">J</span> <span class="pre">mol-1'</span></code>
and <code class="docutils literal notranslate"><span class="pre">'Molecule</span> <span class="pre">Radius</span> <span class="pre">/</span> <span class="pre">m-9'</span></code>, respectively.</p>
<dl class="class">
<dt id="stk.ga.fitness._FitnessFunc">
<em class="property">class </em><code class="descclassname">stk.ga.fitness.</code><code class="descname">_FitnessFunc</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness._FitnessFunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A decorator for fitness functions.</p>
<p>This decorator is applied to all fitness functions automatically in
<a class="reference internal" href="#stk.ga.fitness._calc_fitness" title="stk.ga.fitness._calc_fitness"><code class="xref py py-func docutils literal notranslate"><span class="pre">_calc_fitness()</span></code></a>. It should not be applied explicitly when
defining the functions.</p>
<p>The decorator prevents fitness functions from raising if
they fail (necessary for <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> compatibility),
prevents them from being run twice on the same molecule and stores
the value returned by them in
<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.unscaled_fitness" title="stk.molecular.molecules.MacroMolecule.unscaled_fitness"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.unscaled_fitness</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness._c60_rotations">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">_c60_rotations</code><span class="sig-paren">(</span><em>macro_mol</em>, <em>c60</em>, <em>n5fold</em>, <em>n2fold</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness._c60_rotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates C60 about its axes of symmetry while placed in <cite>macro_mol</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule" title="stk.molecular.molecules.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The cage which should have C60 placed inside it.</li>
<li><strong>c60</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.StructUnit" title="stk.molecular.molecules.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a>) – A StructUnit instance of C60.</li>
<li><strong>n5fold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of rotations along the 5-fold axis of symmetry.</li>
<li><strong>n2fold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of rotations along the 2-fold axis of symmetry per
rotation along the 5-fold axis.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Chem.rdchem.Mol</span></code> – An <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> instance holding the cage / C60 complex.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness._cage_target">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">_cage_target</code><span class="sig-paren">(</span><em>func_name</em>, <em>macro_mol</em>, <em>target</em>, <em>efunc</em>, <em>ofunc</em>, <em>rotation_func</em>, <em>dihedral_SMARTS</em>, <em>target_dihedral</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness._cage_target" title="Permalink to this definition">¶</a></dt>
<dd><p>A general fitness function for calculating fitness of complexes.</p>
<p>This function should be wrapped by other fitness functions which
define their own rotation function. For example <a class="reference internal" href="#stk.ga.fitness.cage_c60" title="stk.ga.fitness.cage_c60"><code class="xref py py-func docutils literal notranslate"><span class="pre">cage_c60()</span></code></a>
and <a class="reference internal" href="#stk.ga.fitness.cage_target" title="stk.ga.fitness.cage_target"><code class="xref py py-func docutils literal notranslate"><span class="pre">cage_target()</span></code></a>.</p>
<p>The function returns a fitness vector consisting of:</p>
<blockquote>
<div><ol class="arabic simple">
<li>binding energy</li>
<li>cavity of cage in complex</li>
<li>asymmetry of cage in complex</li>
<li>strain of cage in complex</li>
<li>cavity of cage by itself</li>
<li>asymmetry of cage by itself</li>
<li>strain of cage by itself</li>
<li>strain in select dihedral angles of the cage by itself</li>
</ol>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The name of the external fitness function calling this one.
Used for the key in <a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.progress_params" title="stk.molecular.molecules.MacroMolecule.progress_params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">progress_params</span></code></a>.</li>
<li><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.Cage" title="stk.molecular.molecules.Cage"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cage</span></code></a>) – The cage which is to have its fitness calculated.</li>
<li><strong>target</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.StructUnit" title="stk.molecular.molecules.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a>) – A molecule to be placed inside the cage cavity.</li>
<li><strong>efunc</strong> (<a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a>) – A <a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a> object representing the energy
function used to calculate energies.</li>
<li><strong>ofunc</strong> (<a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a>) – A <a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a> object representing the optimization
function to be run on the generated complexes.</li>
<li><strong>rotation_func</strong> (<a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a>) – A <a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a> object representing the rotation
function to be used.</li>
<li><strong>dihedral_SMARTS</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The SMARTS code for the dihedral of interest.</li>
<li><strong>target_dihedral</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, optional) – The target value for the dihedral angle.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The numpy array holding the fitness vector.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code> – If the calculation of a fitness parameter fails.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness._calc_fitness">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">_calc_fitness</code><span class="sig-paren">(</span><em>func_data</em>, <em>population</em>, <em>processes</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness._calc_fitness" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the fitness values of all members of a population.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func_data</strong> (<a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">function</span></code>) – <p>A <a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a> instance representing the chosen
fitness function and any additional parameters it may require.</p>
<p>Alternatively, it can be a function which takes 1
argument: the molecule whose fitness is to be calculated.</p>
</li>
<li><strong>population</strong> (<a class="reference internal" href="stk.ga.ga_population.html#stk.ga.ga_population.GAPopulation" title="stk.ga.ga_population.GAPopulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">GAPopulation</span></code></a>) – The population whose members must have their fitness
calculated.</li>
<li><strong>processes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of parallel processes to create.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness._calc_fitness_serial">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">_calc_fitness_serial</code><span class="sig-paren">(</span><em>func_data</em>, <em>population</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness._calc_fitness_serial" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the fitness values of all members of a population.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func_data</strong> (<a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">function</span></code>) – <p>A <a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a> instance representing the chosen
fitness function and any additional parameters it may require.</p>
<p>Alternatively, it can be a function which takes 1
argument: the molecule whose fitness is to be calculated.</p>
</li>
<li><strong>population</strong> (<a class="reference internal" href="stk.ga.ga_population.html#stk.ga.ga_population.GAPopulation" title="stk.ga.ga_population.GAPopulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">GAPopulation</span></code></a>) – The population whose members must have their fitness
calculated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness._generate_complexes">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">_generate_complexes</code><span class="sig-paren">(</span><em>macro_mol</em>, <em>target</em>, <em>number=1</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness._generate_complexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> molecules of cage / target complexes.</p>
<p>If multiple complexes are returned, they will be different via a
random rotation accross the x, y and z axes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.Cage" title="stk.molecular.molecules.Cage"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cage</span></code></a>) – The cage used to form the complex.</li>
<li><strong>target</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.StructUnit" title="stk.molecular.molecules.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a>) – The target used to form the complex.</li>
<li><strong>number</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The number of complexes to be returned.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Chem.rdchem.Mol</span></code> – An <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> instance holding the cage / target complex.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness._make_cage_target_folder">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">_make_cage_target_folder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness._make_cage_target_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a folder to store molecules made by <a class="reference internal" href="#stk.ga.fitness._cage_target" title="stk.ga.fitness._cage_target"><code class="xref py py-func docutils literal notranslate"><span class="pre">_cage_target()</span></code></a>.</p>
<p>The function creates a folder called <code class="docutils literal notranslate"><span class="pre">cage_target</span></code>.
Inside will be any complexes formed by the <a class="reference internal" href="#stk.ga.fitness._cage_target" title="stk.ga.fitness._cage_target"><code class="xref py py-func docutils literal notranslate"><span class="pre">_cage_target()</span></code></a>.
The folder will be placed in the current working directory, or
if the GA is running, 1 above the current working dirctory. This
prevents the generated molecules from being cleaned up by the GA
when it’s finished.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The path of the <code class="docutils literal notranslate"><span class="pre">cage_target</span></code> folder.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness._param_labels">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">_param_labels</code><span class="sig-paren">(</span><em>*labels</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness._param_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the <code class="xref py py-attr docutils literal notranslate"><span class="pre">param_labels</span></code> attribute to a fitness function.</p>
<p>The point of this decorator is described in <a class="reference internal" href="#plotting-note"><span class="std std-ref">A note on plotting.</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>*labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – This function takes an arbitrary number of strings. The strings
are the y-axis labels for each graph made per variable in
<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.progress_params" title="stk.molecular.molecules.MacroMolecule.progress_params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.progress_params</span></code></a>. The order of strings
must correspond to the order of variables placed into
<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.progress_params" title="stk.molecular.molecules.MacroMolecule.progress_params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacroMolecule.progress_params</span></code></a>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The decorated function, with the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">param_labels</span></code>
added. <code class="xref py py-attr docutils literal notranslate"><span class="pre">param_labels</span></code> holds the strings provided in
<cite>*labels</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">function</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@_param_labels</span><span class="p">(</span><span class="s1">&#39;ONE&#39;</span><span class="p">,</span> <span class="s1">&#39;TWO&#39;</span><span class="p">,</span> <span class="s1">&#39;THREE&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">some_func</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span>

<span class="n">some_func</span><span class="o">.</span><span class="n">param_labels</span>  <span class="c1"># [&#39;ONE&#39;, &#39;TWO&#39;, &#39;THREE&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness.building_block_atoms">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">building_block_atoms</code><span class="sig-paren">(</span><em>macro_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness.building_block_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of atoms in the molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule" title="stk.molecular.molecules.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The molecule having its fitness calculated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The number of atoms in <cite>macro_mol</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness.cage">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">cage</code><span class="sig-paren">(</span><em>macro_mol</em>, <em>pseudoformation_params={'func': FunctionData('rdkit'</em>, <em>forcefield='mmff')}</em>, <em>dihedral_SMARTS=''</em>, <em>target_dihedral=180</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness.cage" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the fitness vector of a cage.</p>
<p>The fitness vector consists of the following properties in the
listed order</p>
<blockquote>
<div><ol class="arabic simple">
<li><cite>cavity</cite> - the diameter of the cage pore.</li>
<li><cite>window</cite> - the diameter of the largest cage window.</li>
<li><cite>asymmetry</cite> - the sum of the size differences of all the
windows in <cite>macro_mol</cite>.</li>
<li><cite>eng_per_bond</cite> - The formation energy of <cite>macro_mol</cite> per
bond made.</li>
<li><cite>prec_strain</cite> - The mean rmsd between the free building
block and those in the macromolecule.</li>
<li><cite>dihedral_strain</cite> - The % relative difference between the
average dihedral angle within the molecule and a target
value. The user must provide the SMARTS for the dihedral and
the target value.</li>
</ol>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.Cage" title="stk.molecular.molecules.Cage"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cage</span></code></a>) – The cage whose fitness is to be calculated.</li>
<li><strong>dihedral_SMARTS</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The SMARTS code for the dihedral of interest.</li>
<li><strong>target_dihedral</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, optional) – The target value for the dihedral angle.</li>
<li><strong>pseudoformation_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – This fitness function calculates the formation energy using
<a class="reference internal" href="stk.molecular.energy.html#stk.molecular.energy.Energy.pseudoformation" title="stk.molecular.energy.Energy.pseudoformation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Energy.pseudoformation()</span></code></a>. This parameter defines the
arguments passed to this method via a dictionary. The name of
the argument is the key and the value of the argument is the
value.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The numpy array holding the fitness vector.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code> – If the calculation of a fitness parameter fails.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness.cage_c60">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">cage_c60</code><span class="sig-paren">(</span><em>macro_mol</em>, <em>c60</em>, <em>efunc</em>, <em>ofunc</em>, <em>n5fold</em>, <em>n2fold</em>, <em>dihedral_SMARTS=''</em>, <em>target_dihedral=180</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness.cage_c60" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the fitness vector of a cage / C60 complex.</p>
<p>The difference between this function and <a class="reference internal" href="#stk.ga.fitness.cage_target" title="stk.ga.fitness.cage_target"><code class="xref py py-func docutils literal notranslate"><span class="pre">cage_target()</span></code></a> is
that the rotations are specifically aimed at sampling C60 entirely
and systematically. Rather than the random sampling used by the
other function.</p>
<p>The function returns a fitness vector consisting of:</p>
<blockquote>
<div><ol class="arabic simple">
<li>binding energy</li>
<li>cavity of cage in complex</li>
<li>asymmetry of cage in complex</li>
<li>strain of cage in complex</li>
<li>cavity of cage by itself</li>
<li>asymmetry of cage by itself</li>
<li>strain of cage by itself</li>
<li>strain in select dihedral angles of the cage by itself</li>
</ol>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.Cage" title="stk.molecular.molecules.Cage"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cage</span></code></a>) – The cage which is to have its fitness calculated.</li>
<li><strong>c60</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.StructUnit" title="stk.molecular.molecules.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a>) – A C60 molecule to be placed inside the cage cavity.</li>
<li><strong>efunc</strong> (<a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a>) – A <a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a> object representing the energy
function used to calculate energies.</li>
<li><strong>ofunc</strong> (<a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a>) – A <a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a> object representing the optimization
function to be run on the generated complexes.</li>
<li><strong>n5fold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of rotations along the 5-fold axis of symmetry.</li>
<li><strong>n2fold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of rotations along the 2 fold axis of symmetry per
rotation along the 5-fold axis.</li>
<li><strong>dihedral_SMARTS</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The SMARTS code for the dihedral of interest.</li>
<li><strong>target_dihedral</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, optional) – The target value for the dihedral angle.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The numpy array holding the fitness vector.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code> – If the calculation of a fitness parameter fails.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness.cage_target">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">cage_target</code><span class="sig-paren">(</span><em>macro_mol</em>, <em>target</em>, <em>efunc</em>, <em>ofunc</em>, <em>dihedral_SMARTS=''</em>, <em>target_value=180</em>, <em>rotations=0</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness.cage_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the fitness vector of a cage / target complex.</p>
<p>The target is randomly rotated inside the cage’s cavity and the
most stable conformation found is used.</p>
<p>The function returns a fitness vector consisting of:</p>
<blockquote>
<div><ol class="arabic simple">
<li>binding energy</li>
<li>cavity of cage in complex</li>
<li>asymmetry of cage in complex</li>
<li>strain of cage in complex</li>
<li>cavity of cage by itself</li>
<li>asymmetry of cage by itself</li>
<li>strain of cage by itself</li>
<li>strain in select dihedral angles of the cage by itself</li>
</ol>
</div></blockquote>
<p class="rubric">Notes</p>
<p>This function modifies <cite>macro_mol</cite>. It places the calculated
fitness parameters into <a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.progress_params" title="stk.molecular.molecules.MacroMolecule.progress_params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">progress_params</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.Cage" title="stk.molecular.molecules.Cage"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cage</span></code></a>) – The cage which is to have its fitness calculated.</li>
<li><strong>target</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.StructUnit" title="stk.molecular.molecules.StructUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructUnit</span></code></a>) – A molecule to be placed inside the cage cavity.</li>
<li><strong>efunc</strong> (<a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a>) – A <a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a> object representing the energy
function used to calculate energies.</li>
<li><strong>ofunc</strong> (<a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a>) – A <a class="reference internal" href="stk.utilities.utilities.html#stk.utilities.utilities.FunctionData" title="stk.utilities.utilities.FunctionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></a> object representing the optimization
function to be run on the generated complexes.</li>
<li><strong>dihedral_SMARTS</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The SMARTS code for the dihedral of interest.</li>
<li><strong>target_value</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, optional) – A number representing the target value for the dihedral angle.</li>
<li><strong>rotations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The number of times the target should be randomly rotated
within the cage cavity in order to find the most stable
conformation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The numpy array holding the fitness vector.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code> – If the calculation of a fitness parameter fails.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness.partial_raiser">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">partial_raiser</code><span class="sig-paren">(</span><em>macro_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness.partial_raiser" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates fitness or raises at random.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule" title="stk.molecular.molecules.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The molecule having its fitness calculated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The result of applying <a class="reference internal" href="#stk.ga.fitness.random_fitness_vector" title="stk.ga.fitness.random_fitness_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">random_fitness_vector()</span></code></a> to
<cite>macro_mol</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code> – Raised at random.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness.raiser">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">raiser</code><span class="sig-paren">(</span><em>macro_mol</em>, <em>param1</em>, <em>param2=2</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness.raiser" title="Permalink to this definition">¶</a></dt>
<dd><p>Doens’t calculate a fitness value, raises an error instead.</p>
<p>This function is used for tests to ensure that when fitness
functions raise errors, they are handeled correctly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule" title="stk.molecular.molecules.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The molecule having its fitness calculated.</li>
<li><strong>param1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>) – Dummy parameter, does nothing.</li>
<li><strong>param2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>, optional) – Dummy keyword parameter, does nothing.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong> – This function does not return. It only raises.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code> – An exception is always raised.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness.random_fitness">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">random_fitness</code><span class="sig-paren">(</span><em>macro_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness.random_fitness" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random fitness value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule" title="stk.molecular.molecules.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The molecule for which a fitness value is to be calculated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A random postive number.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stk.ga.fitness.random_fitness_vector">
<code class="descclassname">stk.ga.fitness.</code><code class="descname">random_fitness_vector</code><span class="sig-paren">(</span><em>macro_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.ga.fitness.random_fitness_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 4 element array of random numbers.</p>
<p class="rubric">Notes</p>
<p>This function places the array into
<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule.progress_params" title="stk.molecular.molecules.MacroMolecule.progress_params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">progress_params</span></code></a> of <cite>macro_mol</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>macro_mol</strong> (<a class="reference internal" href="stk.molecular.molecules.html#stk.molecular.molecules.MacroMolecule" title="stk.molecular.molecules.MacroMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">MacroMolecule</span></code></a>) – The molecule for which a fitness value is to be calculated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An array holding the 4 random numbers.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Lukas Turcani

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>